use structures::tcb::{tcb, tcb_init, tbc_init_func};
use utils::buddy_alloc::frame_alloc;
use utils::stdlib::mos_memcpy;
use arch::regs::gpregs;

extern fn get_eflags() -> u32;

struct context {
    eflags: u32,
    gpregs: gpregs,
    tbc_init_func: u32,
    return_addr: u32,
}

fn fill_context(tcb: *tcb) {
    tcb->context->eflags = get_eflags();
    tcb->context->gpregs.ebp = (&(tcb->context->tbc_init_func) as u32) -
        sizeof(u32);
}
